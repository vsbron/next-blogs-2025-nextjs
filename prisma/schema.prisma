
datasource db {
  provider = "postgresql"
  url = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

generator client {
  provider = "prisma-client-js"
}

// ENUMS
enum Gender {
  Male
  Female
  Unknown
}

// MODELS
model User {
  clerkId         String        @id
  email           String        @unique
  username        String        @unique
  imageUrl        String?
  dateCreated     DateTime      @default(now())
  
  displayName     String
  birthday        String?
  gender          Gender        @default(Unknown)
  country         String?
  bio             String?
  socials         Json 

  posts           Post[]
  likes           Like[]
  categories      String[]
}

model Post {
  id              Int           @id @default(autoincrement())
  title           String
  preview         String
  text            String
  imageUrl        String
  published       DateTime      @default(now())
  updated         DateTime      @updatedAt
  authorId        String
  author          User          @relation(fields: [authorId], references: [clerkId])
  likes           Like[]
  views           Int           @default(0)
} 

model Like {
  id              Int           @id @default(autoincrement())
  user            User          @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
  userId          String
  post            Post          @relation(fields: [postId], references: [id], onDelete: Cascade)
  postId          Int
  @@unique([userId,postId])
}